{
    "_contenttype": "template",
    "_finalization_datetime": "2020-05-03T09:53:04+0200",
    "_finalized_by": "theus",
    "body": "{% extends '@EMSCH\/template\/variables.twig' %}\r\n{% trans_default_domain trans_default_domain %}\r\n{% set targetGroup = app.request.get('_target_group') %}\r\n\r\n{% block request -%}\r\n\r\n{% set config = attribute(targetConfigs, targetGroup) %}\r\n{% set newsSearch = emsch_search('news', {\r\n    \"size\": 50,\r\n    \"sort\": [ { \"search_dates\": { \"order\": \"desc\" } } ],\r\n    \"query\": {\r\n        \"bool\": {\r\n          \"must\": [\r\n            { \"term\": { (\"show_#{locale}\"): { \"value\": true } } },\r\n            {\r\n              \"bool\": {\r\n                \"minimum_should_match\": 1,\r\n                \"should\": [\r\n                  { \"terms\": { \"target_group\": [ \"#{targetGroup}\" ] } },\r\n                  { \"bool\": {  \"must_not\": [ \r\n                    { \"exists\": { \"field\": \"target_group\" } } ] } }\r\n                    ]\r\n                }\r\n            }\r\n          ]\r\n        }\r\n      }\r\n})  %}\r\n{% set newsItems = newsSearch.hits.hits %}\r\n\r\n{% set host = 'https:\/\/' ~ targetConfig.hostPattern|replace({ ('%locale%') : locale, ('%environment%'): environment }) %}\r\n{% if targetConfig.isLive and 'live' == environment  %}\r\n    {% set host = 'https:\/\/' ~ attribute(targetConfig.canonicals, l)  %}\r\n{% endif %}\r\n \r\n\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<rss version=\"2.0\">\r\n    <channel>\r\n        <title>{{ \"rss.#{targetGroup}.title\"|trans }}<\/title>\r\n        <description>{{ \"rss.#{targetGroup}.description\"|trans }}<\/description>\r\n        <language>{{ app.request.locale }}<\/language>\r\n        <link>{{ host  }}{{ path(\"emsch_target_#{targetGroup}\") }}<\/link>\r\n        <image>{{ host  }}{{ asset('bundles\/emsch_assets\/img\/full-logo-' ~ app.request.locale ~ '.png') }}?{{ siteHashAssets }}<\/image>\r\n        {% for newsItem in newsItems %}\r\n            <item>\r\n                <title>{{ attribute(newsItem._source, \"title_#{locale}\") }}<\/title>\r\n                <description>{{ attribute(newsItem._source, \"summary_#{locale}\")|replace(wyiwygReplaces)|emsch_routing|e('html') }}<\/description>\r\n                <pubDate>{{ newsItem._source.search_dates|first|date('r') }}<\/pubDate>\r\n                <link>{{ host  }}{{ path(\"emsch_news_item_#{targetGroup}\", {year: newsItem._source.search_dates|first|date('Y'), month: newsItem._source.search_dates|first|date('m'), day: newsItem._source.search_dates|first|date('d'), 'slug': newsItem._source|locale_attr('slug_')} ) }}<\/link>\r\n            <\/item>\r\n        {% endfor %}\r\n    <\/channel>\r\n<\/rss>\r\n{% endblock -%}",
    "name": "rss\/news.xml.json",
    "_sha1": "1b6fc5696aad1284feab4fa9133fc419234620b6",
    "_published_datetime": "2021-01-17T21:33:55+0100"
}