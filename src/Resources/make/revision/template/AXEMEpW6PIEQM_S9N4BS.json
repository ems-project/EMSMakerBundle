{
    "_contenttype": "template",
    "_finalization_datetime": "2020-05-13T13:58:46+0200",
    "_finalized_by": "theus",
    "body": "{% extends '@EMSCH\/template\/variables.twig' %}\r\n{% trans_default_domain trans_default_domain %}\r\n\r\n{% set targetGroup = app.request.get('_target_group')|default(false) %}\r\n{% if not targetGroup %}\r\n    {% set targetGroup = 'site' %}\r\n{% endif %}\r\n\r\n\r\n{% set targets = emsch_search('target', {\r\n    \"_source\": [\"slugs\", \"menu_ids\", \"target_group\", \"locales\", \"title\"],\r\n    \"size\": 20\r\n}).hits.hits|default([]) %}\r\n    \r\n{% set byTarget = {} %}\r\n{% for target in targets %}\r\n    {% set slugByUid = {} %}\r\n    {% set uidBySlug = {} %}\r\n    {% for slug in target._source.slugs|default([]) %}\r\n        {% if target._source.menu_ids[loop.index0]|default(false) %}\r\n            {% set uidBySlug = uidBySlug|merge({ (slug): (target._source.menu_ids[loop.index0]) }) %}\r\n            {% set slugByUid = slugByUid|merge({ (target._source.menu_ids[loop.index0]): (slug) }) %}\r\n        {% endif %}\r\n    {% endfor %}\r\n    {% set tempLocale = attribute(byTarget, target._source.locales|default('-'))|default([])|merge({ (target._source.target_group|default('-')) : {\r\n            slugByUid: slugByUid,\r\n            uidBySlug: uidBySlug,\r\n            title: target._source.title|default('Home')\r\n        } }) %}\r\n    {% set byTarget = byTarget|merge({ (target._source.locales|default('-')) : tempLocale }) %}\r\n{% endfor %}\r\n\r\n\r\n{% set currentTarget = emsch_search('target', {\r\n    \"query\": {\r\n        \"bool\": {\r\n            \"must\": [\r\n                { \"term\": {  \"target_group\": {  \"value\": targetGroup } } },\r\n                { \"term\": { \"locales\": { \"value\": app.request.locale } } }\r\n            ]\r\n        }\r\n    }\r\n}).hits.hits.0._source|default({}) %}\r\n\r\n\r\n{% set taxonomies = {} %}\r\n{% for taxonomy in emsch_search('taxonomy', {\r\n            _source: [\"title_#{app.request.locale}\", \"type\"],\r\n            size: 100,\r\n            query: {\r\n                term: {\r\n                    target_group: targetGroup\r\n                },\r\n            },\r\n            sort: [{ 'order': { 'order': 'asc' } }]\r\n        }).hits.hits|default([]) %}\r\n        \r\n       {% set taxonomies = taxonomies|merge({ (taxonomy._id): taxonomy._source }) %} \r\n{% endfor %}\r\n\r\n{% block title_tag -%}\r\n    {%- if 'live' != environment -%}\r\n        {{ environment|upper ~ ': ' }}\r\n    {%- endif -%}\r\n    {% block title %}{{ 'site.tagline'|trans }}{% endblock title %} | {{ 'site.name'|trans -}}\r\n{%- endblock title_tag %}\r\n\r\n{% block request -%}\r\n    {% set routeName = app.request.get('_route') %}\r\n    {% set languageRoutes = [] %}\r\n    {% for language, l in targetConfig.locales|filter(v => (v != locale and (attribute(source, 'show_'~v) is defined ? attribute(source, 'show_'~v) == true : true) )) %}\r\n    \r\n        {% set host = '\/\/' ~ targetConfig.hostPattern|replace({ ('%locale%') : l, ('%environment%'): environment }) %}\r\n        \r\n        {% if targetConfig.isLive and 'live' == environment  %}\r\n            {% set host = '\/\/' ~ attribute(targetConfig.canonicals, l)  %}\r\n        {% endif %}\r\n        \r\n        {% if host == app.request.host %}\r\n            {% set host = '' %}\r\n        {% endif %}\r\n        \r\n        {% set route = '' %}\r\n        {% if attribute(source, '_contenttype')|default(false) == 'page' %}\r\n        \r\n            {% set params = { 'slug': attribute(source, 'slug_'~l), '_locale': l } %}\r\n            {% set route = path('emsch_page', params) %}\r\n            \r\n            {% for menuId in attribute(source, 'menu_'~l)|default([]) %}\r\n                {% if attribute(attribute(attribute(byTarget, l), targetGroup).slugByUid, menuId)|default(false)  %}\r\n                    {% set lSlug =attribute(attribute(attribute(byTarget, l), targetGroup).slugByUid, menuId) %}\r\n                    {% if lSlug == '\/' %}\r\n                        {% set route = path('emsch_target_'~targetGroup, params|merge({'slug': null, '_locale': l})) %}\r\n                    {% else %}\r\n                        {% set route = path('emsch_target_'~targetGroup, params|merge({'slug': lSlug, '_locale': l})) %}\r\n                    {% endif %}\r\n                    \r\n                {% endif %}\r\n            {% endfor %}\r\n        \r\n        {% elseif (routeName != '' and routeName[-3:3] == '.'~locale) %} {# translated route (path is array) #}\r\n            {% set params = app.request.get('_route_params') %}\r\n            {% if not attribute(params, \"slug\")|default(false) %}\r\n                {% set route = path(routeName[0:-3], params|merge({ _locale : l })) %}\r\n            {% elseif attribute(source, \"slug_#{l}\")|default(false)  %}\r\n                {% set route = path(routeName[0:-3], params|merge({ (\"slug\") : attribute(source, \"slug_#{l}\"), _locale : l })) %}\r\n            {% elseif attribute(source, \"slug\")|default(false)  %}\r\n                {% set route = path(routeName[0:-3], params|merge({ (\"slug\") : attribute(source, \"slug\"), _locale : l })) %}\r\n            {% else %}\r\n                {% set route = path(\"emsch_target_#{targetGroup}.#{l}\") %}\r\n            {% endif %}\r\n        {% elseif (routeName != '') %} \r\n            {% set params = app.request.get('_route_params') %}\r\n            {# {% if host == app.request.host %}\r\n                {% set params = params|merge({'_locale': l}) %}\r\n            {% endif %} #}\r\n            {% set route = path(routeName, params) %}\r\n        {% endif %}\r\n        \r\n        {% set languageRoutes = languageRoutes|merge([{\r\n            'language': language, \r\n            'locale': l,\r\n            'route': host ~ route|default('#')\r\n        }]) %}\r\n        \r\n    {% endfor %}\r\n\r\n{%- block subrequest -%}\r\n<!doctype html>\r\n<html lang=\"{{ app.request.locale|e('html_attr') }}\" \r\n    data-trans-default-domain=\"{{ trans_default_domain|e('html_attr') }}\" \r\n    data-environment=\"{{ environment|e('html_attr') }}\" \r\n    data-asset-path=\"{{ asset('bundles\/emsch_assets\/')|e('html_attr') }}\">\r\n  <head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\r\n    <meta name=\"description\" content=\"{% block description %}{{ 'site.tagline'|trans }}{% endblock %}\">\r\n    <meta name=\"author\" content=\"{% block author %}{{ 'site.author'|trans }}{% endblock %}\">\r\n    <link rel=\"icon\" href=\"{{ asset('bundles\/emsch_assets\/img\/favicon.ico') }}?{{ siteHashAssets }}\">\r\n    <link rel=\"apple-touch-icon\" href=\"{{ asset('bundles\/emsch_assets\/img\/apple-touch-icon.png') }}?{{ siteHashAssets }}\">\r\n\r\n    <title>{{ block('title_tag') }}<\/title>\r\n    \r\n    {% block canonical %}\r\n\r\n        {%- set canonical = false -%}\r\n        \r\n        {% if not canonical and source._contenttype|default('_not_a_ct') in ['page'] %}\r\n            {%- for uid in source|locale_attr('menu_')|default([]) -%}\r\n                {%- if not canonical -%}\r\n                    {% for t in targetConfigs|keys %}\r\n                        {% set slug = attribute(attribute(attribute(byTarget, locale), t).slugByUid, uid)|default(false) %}\r\n                        {% if slug %}\r\n                            {% set canonical = path(\"emsch_target_#{t}.#{locale}\", {slug: slug == '\/' ? null : slug}) %}  \r\n                        {% endif %}\r\n                    {% endfor %}  \r\n                {%- endif -%}\r\n            {%- endfor -%}\r\n            {%- if not canonical and source|locale_attr('slug_') -%}\r\n                {% set slug = source|locale_attr('slug_') %}\r\n                {%- for t in source.target_group|default([]) -%}\r\n                    {%- if not canonical -%}\r\n                        {% set canonical = path(\"emsch_target_#{t}.#{locale}\", {slug: slug == '\/' ? null : slug}) %}  \r\n                    {%- endif -%}\r\n                {%- endfor -%}\r\n            {%- endif -%}\r\n        {% endif %}\r\n            \r\n        {% if not canonical and app.request.get('_route') %}\r\n            {%- set canonical = path(app.request.get('_route'), app.request.get('_route_params'))  -%}\r\n        {% endif %}\r\n        \r\n        {% if canonical %}\r\n            <link rel=\"canonical\" href=\"\/\/{{ attribute(targetConfig.canonicals, locale) }}{% block canonicalUrl %}{{ canonical }}{% endblock %}\">\r\n        {% endif %}\r\n    \r\n        {% for lr in languageRoutes %}\r\n            <link rel=\"alternate\" hreflang=\"{{ lr.locale }}\" href=\"{{ lr.route }}\">\r\n        {% endfor %}\r\n    {% endblock %}\r\n        \r\n    <link media=\"screen\" href=\"{{ asset('bundles\/emsch_assets\/css\/index.css') }}?{{ siteHashAssets }}\" rel=\"stylesheet\">\r\n    {{ include('@EMSCH\/template\/assets\/styles.html.twig') }}\r\n  <\/head>\r\n\r\n  <body>\r\n    {% block navbar %}{{ include('@EMSCH\/template\/bootstrap\/navbar.html.twig') }}{% endblock %}\r\n    \r\n    {% block body %}<main role=\"main\" id=\"main-content\"><\/main>{% endblock %}\r\n    \r\n    \r\n    {% block footer %}{{ include('@EMSCH\/template\/bootstrap\/footer.html.twig') }}{% endblock %}\r\n    \r\n    \r\n\r\n\r\n    <script src=\"https:\/\/wcmtech-cdn-preview.prd.ext.socialsecurity.be\/{{ app.request.locale }}\/{{ cdnSiteId|default('AXFeSTO72GwxbXw0Kcwf') }}\/app.js\"><\/script> \r\n    {#<script src=\"https:\/\/cdn.ehealthplatform.info\/{{ app.request.locale }}\/{{ cdnSiteId|default('AXFeSTO72GwxbXw0Kcwf') }}\/app.js?v=1\"><\/script>#}\r\n    <script src=\"{{ asset('bundles\/emsch_assets\/js\/index.js') }}?{{ siteHashAssets }}\"><\/script>\r\n    {% if app.environment == 'dev' %}\r\n        {{ include('@EMSCH\/template\/debug\/dump.html.twig') }}\r\n    {% endif %}\r\n    {{ include('@EMSCH\/template\/assets\/javascript.html.twig') }}\r\n  <\/body>\r\n<\/html>\r\n{%- endblock subrequest -%}\r\n{%- endblock request -%}",
    "name": "base.html.twig",
    "_sha1": "3fdd39fb6a6a21285be95ff33df8614f4fa88e70",
    "_published_datetime": "2021-01-17T21:57:51+0100"
}